{"$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/main/sarif-2.1/schema/sarif-schema-2.1.0.json", "version": "2.1.0", "runs": [{"tool": {"driver": {"name": "Checkov", "version": "3.2.469", "informationUri": "https://checkov.io", "rules": [{"id": "CKV2_AWS_76", "name": "Ensure AWS ALB attached WAFv2 WebACL is configured with AMR for Log4j Vulnerability", "shortDescription": {"text": "Ensure AWS ALB attached WAFv2 WebACL is configured with AMR for Log4j Vulnerability"}, "fullDescription": {"text": "Ensure AWS ALB attached WAFv2 WebACL is configured with AMR for Log4j Vulnerability"}, "help": {"text": "Ensure AWS ALB attached WAFv2 WebACL is configured with AMR for Log4j Vulnerability\nResource: aws_lb.main"}, "defaultConfiguration": {"level": "error"}}], "organization": "bridgecrew"}}, "results": [{"ruleId": "CKV2_AWS_76", "ruleIndex": 0, "level": "error", "attachments": [], "message": {"text": "Ensure AWS ALB attached WAFv2 WebACL is configured with AMR for Log4j Vulnerability"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "infrastructure/load_balancer.tf"}, "region": {"startLine": 246, "endLine": 271, "snippet": {"text": "resource \"aws_lb\" \"main\" {\n  name               = \"meqenet-main-alb\"\n  internal           = false\n  load_balancer_type = \"application\"\n  security_groups    = [aws_security_group.alb.id]\n  subnets            = [aws_subnet.public_a.id, aws_subnet.public_b.id]\n\n  enable_deletion_protection = true\n\n  # Fix CKV_AWS_91 - Enable access logging\n  access_logs {\n    bucket  = aws_s3_bucket.alb_logs.id\n    enabled = true\n    prefix  = \"alb-logs\"\n  }\n\n  # Fix CKV_AWS_131 - Drop invalid HTTP headers\n  drop_invalid_header_fields = true\n\n  # Fix CKV_AWS_328 - Defensive desync mitigation mode (already satisfied by default)\n  desync_mitigation_mode = \"defensive\"\n\n  tags = {\n    Name = \"meqenet-main-alb\"\n  }\n}\n"}}}}]}]}]}
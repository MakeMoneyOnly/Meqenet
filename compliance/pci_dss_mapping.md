# PCI DSS v4.0 Control Mapping

This document maps the requirements of the Payment Card Industry Data Security Standard (PCI DSS)
v4.0 to the security controls implemented within the Meqenet 2.0 ecosystem.

**Persona:** Compliance & Risk Officer

| Requirement                                                                          | Description                                                                                      | Control Implementation (References)                                                                                                                                                                                                                                                                                                                                            | Evidence Source (Automated wherever possible)                                                                                                                                        |
| ------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **Goal 1: Build and Maintain a Secure Network and Systems**                          |
| 1. Install and Maintain Network Security Controls                                    | Implement and maintain network security controls.                                                | - **Network Policies:** Strict Kubernetes Network Policies and AWS Security Groups to define service-to-service communication. Default-deny all traffic. (`07-Security.md`, 1.2) <br> - **API Gateway:** Centralized security for all ingress traffic. (`07-Security.md`, 2.2) <br> - **Firewall:** Implicitly managed via cloud-native security groups and network ACLs.      | - `scripts/compliance/check_aws_security_groups.sh` <br> - Kubernetes network policy configurations (`infrastructure/k8s/`) <br> - API Gateway configuration review.                 |
| 2. Apply Secure Configurations to All System Components                              | Apply secure configurations to all system components.                                            | - **Secure Development Lifecycle:** Security integrated throughout the development process. (`07-Security.md`, 2.1) <br> - **Minimal Base Images:** Use of "distroless" base images for containers. (`07-Security.md`, 1.4) <br> - **Secrets Management:** Centralized secrets vault (e.g., HashiCorp Vault, AWS Secrets Manager). No secrets in code. (`07-Security.md`, 1.3) | - CI/CD pipeline logs (vulnerability scans). <br> - `scripts/compliance/check_secrets_in_code.sh` (placeholder for a static analysis tool). <br> - Configuration files for services. |
| **Goal 2: Protect Account Data**                                                     |
| 3. Protect Stored Account Data                                                       | Protect stored cardholder data.                                                                  | - **Data at Rest Encryption:** AES-256-GCM encryption for all sensitive data. Field-level encryption for PAN. (`07-Security.md`, 4.2) <br> - **Key Management:** Use of Hardware Security Modules (HSMs) and services like AWS KMS. (`07-Security.md`, 4.2) <br> - **Data Masking & Tokenization:** For non-production environments. (`07-Security.md`, 4.3)                   | - `scripts/compliance/check_s3_encryption.py` <br> - Database configuration review. <br> - KMS key policies review.                                                                  |
| 4. Protect Cardholder Data with Strong Cryptography During Transmission              | Protect cardholder data with strong cryptography during transmission over open, public networks. | - **Data in Transit Encryption:** TLS 1.3 for all external communications. (`07-Security.md`, 4.2) <br> - **Mutual TLS (mTLS):** Mandatory for all internal service-to-service communication. (`07-Security.md`, 1.2) <br> - **Certificate Pinning:** For mobile applications. (`07-Security.md`, 4.2)                                                                         | - Web server/ingress controller configuration review. <br> - Service mesh (e.g., Istio, Linkerd) configuration. <br> - Mobile app source code review.                                |
| **Goal 3: Maintain a Vulnerability Management Program**                              |
| 5. Protect All Systems and Networks from Malicious Software                          | Protect all systems and networks from malicious software.                                        | - **Container & Image Security:** Vulnerability scanning for all container images in the CI/CD pipeline. (`07-Security.md`, 1.4) <br> - **Immutable Containers:** Containers are immutable; updates require building and redeploying a new image. (`07-Security.md`, 1.4)                                                                                                      | - CI/CD pipeline logs showing vulnerability scan results (e.g., Trivy, Snyk). <br> - `scripts/compliance/scan_container_images.sh`                                                   |
| 6. Develop and Maintain Secure Systems and Software                                  | Develop and maintain secure systems and software.                                                | - **Secure Development Lifecycle (SDL):** Security is integrated into every phase of development. (`07-Security.md`, 2.1) <br> - **DevSecOps Integration:** Security testing integrated into CI/CD pipelines (SAST, DAST). (`07-Security.md`, 7.2) <br> - **Third-Party Library Scanning:** Software supply chain security scanning. (`07-Security.md`, 11.2)                  | - CI/CD pipeline logs. <br> - SAST/DAST tool reports. <br> - Software Bill of Materials (SBOM) reports.                                                                              |
| **Goal 4: Implement Strong Access Control Measures**                                 |
| 7. Restrict Access to System Components and Cardholder Data by Business Need to Know | Restrict access to system components and cardholder data by business need to know.               | - **Principle of Least Privilege:** Applied to users, services, and systems. (`07-Security.md`, 2.1) <br> - **Role-Based Access Control (RBAC):** Defined roles for users, merchants, and administrators. (`07-Security.md`, 3.2) <br> - **Attribute-Based Access Control (ABAC):** For dynamic, context-aware permissions. (`07-Security.md`, 3.2)                            | - IAM role and policy review (`scripts/compliance/check_iam_policies.sh`). <br> - Application-level RBAC configuration review. <br> - Database access control lists.                 |
| 8. Identify Users and Authenticate Access to System Components                       | Identify users and authenticate access to system components.                                     | - **Multi-Factor Authentication (MFA):** Mandatory for all users, especially administrators. (`07-Security.md`, 3.1) <br> - **Strong Authentication:** Biometric, PIN, password, social login options. (`04-PRD.md`, Core Features) <br> - **Service-to-Service Authentication:** mTLS is mandatory. (`07-Security.md`, 1.2)                                                   | - `scripts/compliance/check_iam_mfa.sh` <br> - Application authentication logs. <br> - Service mesh configuration.                                                                   |
| 9. Restrict Physical Access to Cardholder Data                                       | Restrict physical access to cardholder data.                                                     | - **Cloud-Based Infrastructure:** Physical security is managed by the cloud provider (e.g., AWS).                                                                                                                                                                                                                                                                              | - Cloud provider's compliance reports (e.g., AWS SOC 2 report).                                                                                                                      |
| **Goal 5: Regularly Monitor and Test Networks**                                      |
| 10. Log and Monitor All Access to System Components and Cardholder Data              | Log and monitor all access to system components and cardholder data.                             | - **Centralized Logging:** Using a SIEM for log aggregation and analysis. (`07-Security.md`, 13.1) <br> - **Comprehensive Audit Logging:** For all financial transactions and sensitive data access. (`07-Security.md`, 1.1) <br> - **Real-time Monitoring:** For suspicious patterns and anomalies. (`05-Compliance_Framework.md`, 3.1)                                       | - SIEM dashboards and alerts. <br> - Audit logs from services and databases. <br> - Cloud provider logs (e.g., AWS CloudTrail).                                                      |
| 11. Test Security of Systems and Networks Regularly                                  | Test security of systems and networks regularly.                                                 | - **Vulnerability Assessment Program:** Continuous vulnerability scanning (SAST, DAST, IAST). (`07-Security.md`, 7.2) <br> - **Penetration Testing:** Regular penetration testing by third-party firms. (`07-Security.md`, 7.2) <br> - **Red Team Exercises:** To test security controls and incident response. (`07-Security.md`, 7.2)                                        | - Vulnerability scan reports. <br> - Penetration test reports. <br> - Red team exercise reports.                                                                                     |
| **Goal 6: Maintain an Information Security Policy**                                  |
| 12. Support Information Security with Organizational Policies and Programs           | Support information security with organizational policies and programs.                          | - **Security Framework:** A comprehensive security framework is documented. (`07-Security.md`) <br> - **Compliance Framework:** A compliance framework is documented. (`05-Compliance_Framework.md`) <br> - **Security Training:** For all employees, including developers. (`07-Security.md`, 14.1)                                                                           | - Review of security and compliance documentation. <br> - Training records. <br> - Risk assessment reports.                                                                          |

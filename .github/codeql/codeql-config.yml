---
name: "Meqenet CodeQL Configuration"

# CodeQL configuration for fintech-grade security analysis
# Focused on TypeScript/JavaScript code only (no Java/Kotlin in this project)

# Global settings
disable-default-queries: false
queries:
  # TypeScript/JavaScript Security Queries (Primary)
  - uses: security-and-quality
  - uses: security-extended

# Multi-language security configuration
paths:
  # Backend TypeScript services
  - backend/services/auth-service/src
  - backend/services/api-gateway/src
  - backend/src
  # Frontend TypeScript/React
  - frontend/apps/app/src
  - frontend/apps/website/src
  # Android (if present)
  - frontend/apps/app/android
paths-ignore:
  - "node_modules"
  - "dist"
  - "build"
  - ".git"

# Language-specific configurations
# This project is TypeScript/JavaScript only - no Java/Kotlin code

# TypeScript/JavaScript Security Configuration
javascript:
  # Web application security
  - "js/webview-javascript-enabled"
  - "js/cleartext-storage"
  - "js/insecure-random"
  - "js/insecure-crypto-algorithm"
  - "js/sql-injection"
  - "js/xss"
  - "js/command-injection"
  - "js/path-injection"
  - "js/hardcoded-credentials"
  - "js/cleartext-transmission"
  - "js/insecure-temporary-file"
  - "js/overly-permissive-file-permissions"
  - "js/dangerous-permissions"
  - "js/improper-code-sanitization"

typescript:
  # Same JavaScript security rules apply to TypeScript
  - "js/webview-javascript-enabled"
  - "js/cleartext-storage"
  - "js/insecure-random"
  - "js/insecure-crypto-algorithm"
  - "js/sql-injection"
  - "js/xss"
  - "js/command-injection"
  - "js/path-injection"
  - "js/hardcoded-credentials"
  - "js/cleartext-transmission"
  - "js/insecure-temporary-file"
  - "js/overly-permissive-file-permissions"
  - "js/dangerous-permissions"
  - "js/improper-code-sanitization"

# Severity thresholds for fintech compliance
severity:
  critical: ["sql-injection", "hardcoded-credentials", "insecure-crypto"]
  high: ["cleartext-storage", "cleartext-traffic", "dangerous-permissions"]
  medium: ["webview-javascript-enabled", "overly-permissive-permissions"]
  low: ["insecure-random", "implicit-pendingintent"]

# Custom query suites for fintech-specific security (TypeScript/JavaScript only)
query-suites:
  - name: "fintech-security"
    description: "Fintech-specific security queries for Meqenet"
    queries:
      - "js/fintech/sensitive-data-exposure"
      - "ts/fintech/sensitive-data-exposure"
      - "js/fintech/insecure-data-transmission"
      - "ts/fintech/insecure-data-transmission"

# Exclude false positives for known safe patterns
exclude:
  paths:
    - "**/test*/**"
    - "**/*Test.*"
    - "**/*Tests.*"
    - "**/*.spec.*"
    - "**/*.test.*"
    - "**/node_modules/**"
    - "**/dist/**"
    - "**/build/**"
    - "**/coverage/**"
    - "**/.nx/**"
    - "**/.git/**"
    - "**/logs/**"
  queries:
    - "js/cleartext-transmission" # May be needed for local development
    - "js/insecure-random" # May be acceptable for non-cryptographic purposes

# Performance optimization
threads: 2
timeout: 300 # 5 minutes per query

# Output configuration
output:
  format: sarif-latest
  file: codeql-results.sarif
